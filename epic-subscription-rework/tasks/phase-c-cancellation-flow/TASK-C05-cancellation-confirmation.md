# TASK-C05: Cancellation Confirmation — финальное подтверждение с датой доступа

## Meta

| Поле | Значение |
|------|----------|
| ID | TASK-C05 |
| Title | Финальный шаг отмены: подтверждение с датой окончания доступа |
| Phase | C — Cancellation Flow |
| Type | Frontend |
| Priority | P0 |
| Estimate | S (1 день) |
| Owner Role | Frontend Developer |

---

## Goal / Why

Финальный шаг cancellation flow: ясное подтверждение с датой окончания доступа. Пользователь должен точно понимать, что произойдёт и когда.

---

## Scope

- UI подтверждения: дата окончания, кнопки
- Для мультимесячных: «Доступ до DD.MM.YYYY» (конец оплаченного периода)
- Для месячных: «Доступ до DD.MM.YYYY» (конец текущего месяца)
- Для trial: «Доступ до DD.MM.YYYY» (trial_ends_at)
- Success state после подтверждения

---

## Dependencies

| Зависимость | Тип |
|-------------|-----|
| TASK-C01 | Cancellation flow |

---

## Detailed Implementation Notes

### Confirmation UI

```
┌──────────────────────────────────────────────┐
│                                              │
│  Подписка будет отменена                     │
│                                              │
│  Доступ сохранится до: 15 августа 2026       │
│  Автопродление будет отключено.              │
│  Вы сможете оформить подписку заново         │
│  в любой момент.                             │
│                                              │
│  [ Подтвердить отмену ]    ← Destructive     │
│  [ Остаться ]              ← Primary          │
│                                              │
└──────────────────────────────────────────────┘
```

### Success UI (после подтверждения)

```
┌──────────────────────────────────────────────┐
│                                              │
│  Подписка отменена                           │
│                                              │
│  Вы можете пользоваться подпиской            │
│  до 15 августа 2026.                         │
│                                              │
│  Передумали? Оформите подписку заново:       │
│  [ Выбрать тариф ]                           │
│                                              │
└──────────────────────────────────────────────┘
```

---

## Acceptance Criteria

- **Given** месячный подписчик подтверждает отмену, **When** confirmed, **Then** видит дату окончания (конец текущего месяца)
- **Given** 6-мес подписчик подтверждает отмену, **When** confirmed, **Then** видит дату окончания оплаченного периода
- **Given** trial подписчик подтверждает отмену, **When** confirmed, **Then** видит trial_ends_at
- **Given** кнопка «Остаться», **When** click, **Then** возврат в ЛК, подписка не отменена

---

## Analytics Events Impacted

- `cancellation_confirmed` {user_id, reason, plan_months, access_until}
- `cancellation_aborted` {user_id, step: "confirmation"} — нажал «Остаться»
